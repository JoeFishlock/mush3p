
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.43">
    
    
      
        <title>mush3p</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.0253249f.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="mush3p" class="md-header__button md-logo" aria-label="mush3p" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            mush3p
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API Reference
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="mush3p" class="md-nav__button md-logo" aria-label="mush3p" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    mush3p
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mush3p" class="md-nav__link">
    <span class="md-ellipsis">
      mush3p
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mush3p.boundary_conditions" class="md-nav__link">
    <span class="md-ellipsis">
      boundary_conditions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="boundary_conditions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mush3p.boundary_conditions.get_boundary_conditions" class="md-nav__link">
    <span class="md-ellipsis">
      get_boundary_conditions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mush3p.model" class="md-nav__link">
    <span class="md-ellipsis">
      model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mush3p.model.full" class="md-nav__link">
    <span class="md-ellipsis">
      full
    </span>
  </a>
  
    <nav class="md-nav" aria-label="full">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mush3p.model.full.FullModel" class="md-nav__link">
    <span class="md-ellipsis">
      FullModel
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FullModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mush3p.model.full.FullModel.gas_fraction_derivative" class="md-nav__link">
    <span class="md-ellipsis">
      gas_fraction_derivative
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mush3p.model.incompressible" class="md-nav__link">
    <span class="md-ellipsis">
      incompressible
    </span>
  </a>
  
    <nav class="md-nav" aria-label="incompressible">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mush3p.model.incompressible.IncompressibleModel" class="md-nav__link">
    <span class="md-ellipsis">
      IncompressibleModel
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mush3p.model.instant" class="md-nav__link">
    <span class="md-ellipsis">
      instant
    </span>
  </a>
  
    <nav class="md-nav" aria-label="instant">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mush3p.model.instant.InstantNucleationModel" class="md-nav__link">
    <span class="md-ellipsis">
      InstantNucleationModel
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mush3p.model.reduced" class="md-nav__link">
    <span class="md-ellipsis">
      reduced
    </span>
  </a>
  
    <nav class="md-nav" aria-label="reduced">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mush3p.model.reduced.ReducedModel" class="md-nav__link">
    <span class="md-ellipsis">
      ReducedModel
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mush3p.output" class="md-nav__link">
    <span class="md-ellipsis">
      output
    </span>
  </a>
  
    <nav class="md-nav" aria-label="output">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mush3p.output.NonDimensionalResults" class="md-nav__link">
    <span class="md-ellipsis">
      NonDimensionalResults
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mush3p.params" class="md-nav__link">
    <span class="md-ellipsis">
      params
    </span>
  </a>
  
    <nav class="md-nav" aria-label="params">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mush3p.params.NonDimensionalParams" class="md-nav__link">
    <span class="md-ellipsis">
      NonDimensionalParams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mush3p.params.PhysicalParams" class="md-nav__link">
    <span class="md-ellipsis">
      PhysicalParams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PhysicalParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mush3p.params.PhysicalParams.eutectic_salinity" class="md-nav__link">
    <span class="md-ellipsis">
      eutectic_salinity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mush3p.params.PhysicalParams.initial_temperature" class="md-nav__link">
    <span class="md-ellipsis">
      initial_temperature
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mush3p.static_settings" class="md-nav__link">
    <span class="md-ellipsis">
      static_settings
    </span>
  </a>
  
    <nav class="md-nav" aria-label="static_settings">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mush3p.static_settings.get_initial_solution" class="md-nav__link">
    <span class="md-ellipsis">
      get_initial_solution
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mush3p" class="md-nav__link">
    <span class="md-ellipsis">
      mush3p
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mush3p.boundary_conditions" class="md-nav__link">
    <span class="md-ellipsis">
      boundary_conditions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="boundary_conditions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mush3p.boundary_conditions.get_boundary_conditions" class="md-nav__link">
    <span class="md-ellipsis">
      get_boundary_conditions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mush3p.model" class="md-nav__link">
    <span class="md-ellipsis">
      model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mush3p.model.full" class="md-nav__link">
    <span class="md-ellipsis">
      full
    </span>
  </a>
  
    <nav class="md-nav" aria-label="full">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mush3p.model.full.FullModel" class="md-nav__link">
    <span class="md-ellipsis">
      FullModel
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FullModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mush3p.model.full.FullModel.gas_fraction_derivative" class="md-nav__link">
    <span class="md-ellipsis">
      gas_fraction_derivative
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mush3p.model.incompressible" class="md-nav__link">
    <span class="md-ellipsis">
      incompressible
    </span>
  </a>
  
    <nav class="md-nav" aria-label="incompressible">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mush3p.model.incompressible.IncompressibleModel" class="md-nav__link">
    <span class="md-ellipsis">
      IncompressibleModel
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mush3p.model.instant" class="md-nav__link">
    <span class="md-ellipsis">
      instant
    </span>
  </a>
  
    <nav class="md-nav" aria-label="instant">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mush3p.model.instant.InstantNucleationModel" class="md-nav__link">
    <span class="md-ellipsis">
      InstantNucleationModel
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mush3p.model.reduced" class="md-nav__link">
    <span class="md-ellipsis">
      reduced
    </span>
  </a>
  
    <nav class="md-nav" aria-label="reduced">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mush3p.model.reduced.ReducedModel" class="md-nav__link">
    <span class="md-ellipsis">
      ReducedModel
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mush3p.output" class="md-nav__link">
    <span class="md-ellipsis">
      output
    </span>
  </a>
  
    <nav class="md-nav" aria-label="output">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mush3p.output.NonDimensionalResults" class="md-nav__link">
    <span class="md-ellipsis">
      NonDimensionalResults
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mush3p.params" class="md-nav__link">
    <span class="md-ellipsis">
      params
    </span>
  </a>
  
    <nav class="md-nav" aria-label="params">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mush3p.params.NonDimensionalParams" class="md-nav__link">
    <span class="md-ellipsis">
      NonDimensionalParams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mush3p.params.PhysicalParams" class="md-nav__link">
    <span class="md-ellipsis">
      PhysicalParams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PhysicalParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mush3p.params.PhysicalParams.eutectic_salinity" class="md-nav__link">
    <span class="md-ellipsis">
      eutectic_salinity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mush3p.params.PhysicalParams.initial_temperature" class="md-nav__link">
    <span class="md-ellipsis">
      initial_temperature
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mush3p.static_settings" class="md-nav__link">
    <span class="md-ellipsis">
      static_settings
    </span>
  </a>
  
    <nav class="md-nav" aria-label="static_settings">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mush3p.static_settings.get_initial_solution" class="md-nav__link">
    <span class="md-ellipsis">
      get_initial_solution
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="api-reference">API Reference</h1>


<div class="doc doc-object doc-module">



<a id="mush3p"></a>
    <div class="doc doc-contents first">

        <p>Simulate steadily solidifying three-phase mushy layers in a Hele-Shaw cell.</p>








  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h2 id="mush3p.boundary_conditions" class="doc doc-heading">
            <code>boundary_conditions</code>


</h2>

    <div class="doc doc-contents ">








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="mush3p.boundary_conditions.get_boundary_conditions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_boundary_conditions</span><span class="p">(</span><span class="n">non_dimensional_params</span><span class="p">,</span> <span class="n">bottom_variables</span><span class="p">,</span> <span class="n">top_variables</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Function to return the boundary conditions for scipy solve_BVP.</p>
<p>The returned array is zero when the boundary conditions are satisfied.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>non_dimensional_params</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="mush3p.params.NonDimensionalParams" href="#mush3p.params.NonDimensionalParams">NonDimensionalParams</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Non-dimensional parameters</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bottom_variables</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of the solution variables evaluated at the bottom boundary.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>top_variables</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of the solution variables evaluated at the top boundary.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>NDArray</code></td>            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>residual of the boundary conditions</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>mush3p/boundary_conditions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_boundary_conditions</span><span class="p">(</span>
    <span class="n">non_dimensional_params</span><span class="p">:</span> <span class="n">NonDimensionalParams</span><span class="p">,</span>
    <span class="n">bottom_variables</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
    <span class="n">top_variables</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Function to return the boundary conditions for scipy solve_BVP.</span>

<span class="sd">    The returned array is zero when the boundary conditions are satisfied.</span>

<span class="sd">    Args:</span>
<span class="sd">        non_dimensional_params (NonDimensionalParams): Non-dimensional parameters</span>
<span class="sd">        bottom_variables (NDArray): Array of the solution variables evaluated at the bottom boundary.</span>
<span class="sd">        top_variables (NDArray): Array of the solution variables evaluated at the top boundary.</span>

<span class="sd">    Returns:</span>
<span class="sd">        NDArray: residual of the boundary conditions</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">OPTIONS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;full&quot;</span><span class="p">:</span> <span class="n">BoundaryConditionsFull</span><span class="p">,</span>
        <span class="s2">&quot;incompressible&quot;</span><span class="p">:</span> <span class="n">BoundaryConditionsIncompressible</span><span class="p">,</span>
        <span class="s2">&quot;reduced&quot;</span><span class="p">:</span> <span class="n">BoundaryConditionsReduced</span><span class="p">,</span>
        <span class="s2">&quot;instant&quot;</span><span class="p">:</span> <span class="n">BoundaryConditionsInstant</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">OPTIONS</span><span class="p">[</span><span class="n">non_dimensional_params</span><span class="o">.</span><span class="n">model_choice</span><span class="p">](</span>
        <span class="n">non_dimensional_params</span><span class="p">,</span> <span class="n">bottom_variables</span><span class="p">,</span> <span class="n">top_variables</span>
    <span class="p">)</span><span class="o">.</span><span class="n">boundary_conditions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="mush3p.model" class="doc doc-heading">
            <code>model</code>


</h2>

    <div class="doc doc-contents ">








  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h3 id="mush3p.model.full" class="doc doc-heading">
            <code>full</code>


</h3>

    <div class="doc doc-contents ">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="mush3p.model.full.FullModel" class="doc doc-heading">
            <code>FullModel</code>


</h4>


    <div class="doc doc-contents ">


        <p>Implement the full model equations and provide the ode_fun method to be used by
scipy solve_BVP.</p>
<p>The gas fraction is calculated by solving a non-linear equation and is fully coupled
to the liquid darcy flux.
Solid, liquid and gas fractions sum to one.
Gas density is calculated from the ideal gas law.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="mush3p.params.NonDimensionalParams" href="#mush3p.params.NonDimensionalParams">NonDimensionalParams</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Non-dimensional parameters</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>height</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Height values</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>temperature</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Temperature values</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>temperature_derivative</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Temperature derivative values</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dissolved_gas_concentration</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dissolved gas concentration values</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>hydrostatic_pressure</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hydrostatic pressure values</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>frozen_gas_fraction</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Frozen gas fraction</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mushy_layer_depth</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mushy layer depth</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>mush3p/model/full.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">FullModel</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Implement the full model equations and provide the ode_fun method to be used by</span>
<span class="sd">    scipy solve_BVP.</span>

<span class="sd">    The gas fraction is calculated by solving a non-linear equation and is fully coupled</span>
<span class="sd">    to the liquid darcy flux.</span>
<span class="sd">    Solid, liquid and gas fractions sum to one.</span>
<span class="sd">    Gas density is calculated from the ideal gas law.</span>

<span class="sd">    Args:</span>
<span class="sd">        params (NonDimensionalParams): Non-dimensional parameters</span>
<span class="sd">        height (NDArray): Height values</span>
<span class="sd">        temperature (NDArray): Temperature values</span>
<span class="sd">        temperature_derivative (NDArray): Temperature derivative values</span>
<span class="sd">        dissolved_gas_concentration (NDArray): Dissolved gas concentration values</span>
<span class="sd">        hydrostatic_pressure (NDArray): Hydrostatic pressure values</span>
<span class="sd">        frozen_gas_fraction (NDArray): Frozen gas fraction</span>
<span class="sd">        mushy_layer_depth (NDArray): Mushy layer depth&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">params</span><span class="p">:</span> <span class="n">NonDimensionalParams</span><span class="p">,</span>
        <span class="n">height</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
        <span class="n">temperature</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
        <span class="n">temperature_derivative</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
        <span class="n">dissolved_gas_concentration</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
        <span class="n">hydrostatic_pressure</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
        <span class="n">frozen_gas_fraction</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
        <span class="n">mushy_layer_depth</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">params</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">height</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="n">temperature</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temperature_derivative</span> <span class="o">=</span> <span class="n">temperature_derivative</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dissolved_gas_concentration</span> <span class="o">=</span> <span class="n">dissolved_gas_concentration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hydrostatic_pressure</span> <span class="o">=</span> <span class="n">hydrostatic_pressure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frozen_gas_fraction</span> <span class="o">=</span> <span class="n">frozen_gas_fraction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mushy_layer_depth</span> <span class="o">=</span> <span class="n">mushy_layer_depth</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">solid_salinity</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">concentration_ratio</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">liquid_salinity</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">temperature</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">solid_fraction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
        <span class="n">concentration_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">concentration_ratio</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">-</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">frozen_gas_fraction</span><span class="p">)</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span>
            <span class="o">/</span> <span class="p">(</span><span class="n">concentration_ratio</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">liquid_fraction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">calculate_liquid_fraction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_fraction</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">solid_fraction</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">gas_darcy_velocity</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">calculate_gas_darcy_velocity</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">solid_fraction</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gas_fraction</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">gas_density</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="k">return</span> <span class="n">calculate_gas_density</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mushy_layer_depth</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hydrostatic_pressure</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">gas_fraction</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">calculate_gas_fraction</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frozen_gas_fraction</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">solid_fraction</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dissolved_gas_concentration</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gas_density</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">liquid_darcy_velocity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">calculate_liquid_darcy_velocity</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gas_fraction</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frozen_gas_fraction</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">permeability</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
        <span class="n">liquid_permeability_reciprocal</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_fraction</span>
        <span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_fraction</span><span class="o">**</span><span class="mi">3</span>
        <span class="n">reference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">hele_shaw_permeability_scaled</span>
        <span class="k">return</span> <span class="p">((</span><span class="mi">1</span> <span class="o">/</span> <span class="n">reference</span><span class="p">)</span> <span class="o">+</span> <span class="n">liquid_permeability_reciprocal</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">saturation_concentration</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nucleation_rate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
        <span class="n">indicator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dissolved_gas_concentration</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">saturation_concentration</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">liquid_fraction</span>
            <span class="o">*</span> <span class="n">indicator</span>
            <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dissolved_gas_concentration</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">saturation_concentration</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">solid_fraction_derivative</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
        <span class="n">concentration_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">concentration_ratio</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">-</span><span class="n">concentration_ratio</span>
            <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">frozen_gas_fraction</span><span class="p">)</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature_derivative</span>
            <span class="o">/</span> <span class="p">(</span><span class="n">concentration_ratio</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">gas_fraction_derivative</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Numerically approximate the derivative with finite difference.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_fraction</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">hydrostatic_pressure_derivative</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">mushy_layer_depth</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_darcy_velocity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">permeability</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">effective_heat_capacity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">solid_specific_heat_capacity_ratio</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">solid_specific_heat_capacity_ratio</span>
        <span class="p">)</span>
        <span class="n">gas_specific_heat_capacity_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">gas_specific_heat_capacity_ratio</span>
        <span class="n">density_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">gas_density_ratio</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="mi">1</span>
            <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">solid_specific_heat_capacity_ratio</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">solid_fraction</span>
            <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">gas_specific_heat_capacity_ratio</span> <span class="o">*</span> <span class="n">density_ratio</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_density</span><span class="p">)</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_fraction</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">effective_thermal_conductivity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">gas_conductivity_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">gas_conductivity_ratio</span>
        <span class="n">solid_conductivity_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">solid_conductivity_ratio</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="mi">1</span>
            <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">solid_conductivity_ratio</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">solid_fraction</span>
            <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">gas_conductivity_ratio</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_fraction</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">temperature_second_derivative</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
        <span class="n">stefan_number</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">stefan_number</span>
        <span class="n">gas_specific_heat_capacity_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">gas_specific_heat_capacity_ratio</span>
        <span class="n">density_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">gas_density_ratio</span>
        <span class="n">gas_conductivity_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">gas_conductivity_ratio</span>
        <span class="n">solid_conductivity_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">solid_conductivity_ratio</span>

        <span class="n">heat_capacity_term</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mushy_layer_depth</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">effective_heat_capacity</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature_derivative</span>
        <span class="p">)</span>
        <span class="n">liquid_advection_term</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mushy_layer_depth</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_darcy_velocity</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature_derivative</span>
        <span class="p">)</span>
        <span class="n">gas_advection_term</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mushy_layer_depth</span>
            <span class="o">*</span> <span class="n">density_ratio</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_density</span>
            <span class="o">*</span> <span class="n">gas_specific_heat_capacity_ratio</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_darcy_velocity</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature_derivative</span>
        <span class="p">)</span>
        <span class="n">latent_heat_term</span> <span class="o">=</span> <span class="p">(</span>
            <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">mushy_layer_depth</span> <span class="o">*</span> <span class="n">stefan_number</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">solid_fraction_derivative</span>
        <span class="p">)</span>
        <span class="n">conductivity_change_term</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">solid_conductivity_ratio</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">solid_fraction_derivative</span>
            <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">gas_conductivity_ratio</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_fraction_derivative</span>
        <span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature_derivative</span>

        <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">effective_thermal_conductivity</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
            <span class="n">heat_capacity_term</span>
            <span class="o">+</span> <span class="n">liquid_advection_term</span>
            <span class="o">+</span> <span class="n">gas_advection_term</span>
            <span class="o">+</span> <span class="n">latent_heat_term</span>
            <span class="o">+</span> <span class="n">conductivity_change_term</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dissolved_gas_concentration_derivative</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>

        <span class="n">damkholer_number</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">damkholer_number</span>
        <span class="n">freezing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dissolved_gas_concentration</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">solid_fraction_derivative</span>
        <span class="n">dissolution</span> <span class="o">=</span> <span class="o">-</span><span class="n">damkholer_number</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mushy_layer_depth</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nucleation_rate</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">freezing</span> <span class="o">+</span> <span class="n">dissolution</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">frozen_gas_fraction</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">solid_fraction</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">check_volume_fractions_sum_to_one</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">solid_fraction</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_fraction</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_fraction</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="o">&gt;</span> <span class="n">VOLUME_SUM_TOLERANCE</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ode_fun</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_volume_fractions_sum_to_one</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Volume fractions do not sum to 1&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">temperature_derivative</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">temperature_second_derivative</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dissolved_gas_concentration_derivative</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">hydrostatic_pressure_derivative</span><span class="p">,</span>
                <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">),</span>
                <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="mush3p.model.full.FullModel.gas_fraction_derivative" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">gas_fraction_derivative</span><span class="p">:</span> <span class="n">NDArray</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

        <p>Numerically approximate the derivative with finite difference.</p>
    </div>

</div>





  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="mush3p.model.incompressible" class="doc doc-heading">
            <code>incompressible</code>


</h3>

    <div class="doc doc-contents ">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="mush3p.model.incompressible.IncompressibleModel" class="doc doc-heading">
            <code>IncompressibleModel</code>


</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="mush3p.model.full.FullModel" href="#mush3p.model.full.FullModel">FullModel</a></code></p>


        <p>implement equations for the incompressible model.</p>
<p>These are identical to the full model but with the dimensionless gas density set to 1.0.</p>






              <details class="quote">
                <summary>Source code in <code>mush3p/model/incompressible.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">IncompressibleModel</span><span class="p">(</span><span class="n">FullModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;implement equations for the incompressible model.</span>

<span class="sd">    These are identical to the full model but with the dimensionless gas density set to 1.0.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">gas_density</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="mush3p.model.instant" class="doc doc-heading">
            <code>instant</code>


</h3>

    <div class="doc doc-contents ">

        <p>The equations for solving the instant nucleation model</p>
<p>All quantities are calculated from the smaller set of variables:
temperature
temperature_derivative
hydrostatic_pressure
frozen_gas_fraction
mushy_layer_depth</p>
<p>height (vertical coordinate)</p>








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="mush3p.model.instant.InstantNucleationModel" class="doc doc-heading">
            <code>InstantNucleationModel</code>


</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="mush3p.model.reduced.ReducedModel" href="#mush3p.model.reduced.ReducedModel">ReducedModel</a></code></p>


        <p>Implements the equations to solve the instant model.</p>
<p>This is an extension of the reduced model where the nucleation rate is infinite and
and so any supersaturations is immediately converted to the gas phase.
This means we do not need to solve the ODE for dissolved gas concentration in this
case.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="mush3p.params.NonDimensionalParams" href="#mush3p.params.NonDimensionalParams">NonDimensionalParams</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Non-dimensional parameters</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>height</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Height values</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>temperature</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Temperature values</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>temperature_derivative</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Temperature derivative values</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>hydrostatic_pressure</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hydrostatic pressure values</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>frozen_gas_fraction</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Frozen gas fraction</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mushy_layer_depth</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mushy layer depth</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>mush3p/model/instant.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">InstantNucleationModel</span><span class="p">(</span><span class="n">ReducedModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Implements the equations to solve the instant model.</span>

<span class="sd">    This is an extension of the reduced model where the nucleation rate is infinite and</span>
<span class="sd">    and so any supersaturations is immediately converted to the gas phase.</span>
<span class="sd">    This means we do not need to solve the ODE for dissolved gas concentration in this</span>
<span class="sd">    case.</span>

<span class="sd">    Args:</span>
<span class="sd">        params (NonDimensionalParams): Non-dimensional parameters</span>
<span class="sd">        height (NDArray): Height values</span>
<span class="sd">        temperature (NDArray): Temperature values</span>
<span class="sd">        temperature_derivative (NDArray): Temperature derivative values</span>
<span class="sd">        hydrostatic_pressure (NDArray): Hydrostatic pressure values</span>
<span class="sd">        frozen_gas_fraction (NDArray): Frozen gas fraction</span>
<span class="sd">        mushy_layer_depth (NDArray): Mushy layer depth&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">params</span><span class="p">:</span> <span class="n">NonDimensionalParams</span><span class="p">,</span>
        <span class="n">height</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
        <span class="n">temperature</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
        <span class="n">temperature_derivative</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
        <span class="n">hydrostatic_pressure</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
        <span class="n">frozen_gas_fraction</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
        <span class="n">mushy_layer_depth</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">params</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">height</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="n">temperature</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temperature_derivative</span> <span class="o">=</span> <span class="n">temperature_derivative</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hydrostatic_pressure</span> <span class="o">=</span> <span class="n">hydrostatic_pressure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frozen_gas_fraction</span> <span class="o">=</span> <span class="n">frozen_gas_fraction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mushy_layer_depth</span> <span class="o">=</span> <span class="n">mushy_layer_depth</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dissolved_gas_concentration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liquid_fraction</span><span class="p">),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">far_dissolved_concentration_scaled</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_fraction</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ode_fun</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_volume_fractions_sum_to_one</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Volume fractions do not sum to 1&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">temperature_derivative</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">temperature_second_derivative</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">hydrostatic_pressure_derivative</span><span class="p">,</span>
                <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">),</span>
                <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="mush3p.model.reduced" class="doc doc-heading">
            <code>reduced</code>


</h3>

    <div class="doc doc-contents ">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="mush3p.model.reduced.ReducedModel" class="doc doc-heading">
            <code>ReducedModel</code>


</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="mush3p.model.incompressible.IncompressibleModel" href="#mush3p.model.incompressible.IncompressibleModel">IncompressibleModel</a></code></p>


        <p>Implement the equations for the reduced model</p>
<p>The reduced model is an approximation to the full model where the exsolved gas
volume fraction is small and incompressible.
Under this approximation scheme the solid and liquid volume fractions sum to 1
and the exsolution of gas does not drive a liquid flow.</p>






              <details class="quote">
                <summary>Source code in <code>mush3p/model/reduced.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ReducedModel</span><span class="p">(</span><span class="n">IncompressibleModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Implement the equations for the reduced model</span>

<span class="sd">    The reduced model is an approximation to the full model where the exsolved gas</span>
<span class="sd">    volume fraction is small and incompressible.</span>
<span class="sd">    Under this approximation scheme the solid and liquid volume fractions sum to 1</span>
<span class="sd">    and the exsolution of gas does not drive a liquid flow.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">liquid_darcy_velocity</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">solid_fraction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
        <span class="n">concentration_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">concentration_ratio</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temperature</span> <span class="o">-</span> <span class="n">concentration_ratio</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">liquid_fraction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">solid_fraction</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">gas_fraction</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">calculate_gas_fraction</span><span class="p">(</span>
            <span class="mi">0</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">solid_fraction</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dissolved_gas_concentration</span><span class="p">,</span>
            <span class="mi">1</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">solid_fraction_derivative</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
        <span class="n">concentration_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">concentration_ratio</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">-</span><span class="n">concentration_ratio</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature_derivative</span>
            <span class="o">/</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">temperature</span> <span class="o">-</span> <span class="n">concentration_ratio</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">hydrostatic_pressure_derivative</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">effective_heat_capacity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">solid_specific_heat_capacity_ratio</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">solid_specific_heat_capacity_ratio</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">solid_specific_heat_capacity_ratio</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">solid_fraction</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">effective_thermal_conductivity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">solid_conductivity_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">solid_conductivity_ratio</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">solid_conductivity_ratio</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">solid_fraction</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">temperature_second_derivative</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
        <span class="n">stefan_number</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">stefan_number</span>
        <span class="n">solid_conductivity_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">solid_conductivity_ratio</span>

        <span class="n">heat_capacity_term</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mushy_layer_depth</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">effective_heat_capacity</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature_derivative</span>
        <span class="p">)</span>
        <span class="n">latent_heat_term</span> <span class="o">=</span> <span class="p">(</span>
            <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">mushy_layer_depth</span> <span class="o">*</span> <span class="n">stefan_number</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">solid_fraction_derivative</span>
        <span class="p">)</span>
        <span class="n">conductivity_change_term</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">solid_conductivity_ratio</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">solid_fraction_derivative</span>
        <span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature_derivative</span>

        <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">effective_thermal_conductivity</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
            <span class="n">heat_capacity_term</span> <span class="o">+</span> <span class="n">latent_heat_term</span> <span class="o">+</span> <span class="n">conductivity_change_term</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dissolved_gas_concentration_derivative</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>

        <span class="n">damkholer_number</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">damkholer_number</span>
        <span class="n">dissolution</span> <span class="o">=</span> <span class="o">-</span><span class="n">damkholer_number</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mushy_layer_depth</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nucleation_rate</span>

        <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_fraction</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dissolved_gas_concentration</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">solid_fraction_derivative</span>
            <span class="o">+</span> <span class="n">dissolution</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">check_volume_fractions_sum_to_one</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">solid_fraction</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_fraction</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
            <span class="o">&gt;</span> <span class="n">VOLUME_SUM_TOLERANCE</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div>


  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="mush3p.output" class="doc doc-heading">
            <code>output</code>


</h2>

    <div class="doc doc-contents ">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="mush3p.output.NonDimensionalResults" class="doc doc-heading">
            <code>NonDimensionalResults</code>


</h3>


    <div class="doc doc-contents ">


        <p>Class to store non-dimensional solution profiles and provide methods to linearly
interpolate them with depth.</p>
<p>The class also provides a save method to serialize the non-dimensional parameters
and solution arrays to a JSON file, and a load method to deserialize them back into
a NonDimensionalResults object.</p>
<p>The class calcualtes all mushy layer arrays using the model specified in the
non-dimensional parameters.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>non_dimensional_parameters</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="mush3p.params.NonDimensionalParams" href="#mush3p.params.NonDimensionalParams">NonDimensionalParams</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Non-dimensional parameters</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>temperature_array</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Temperature profile</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>temperature_derivative_array</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Temperature derivative profile</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>concentration_array</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Concentration profile</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>hydrostatic_pressure_array</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hydrostatic pressure profile</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>frozen_gas_fraction</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Frozen gas fraction</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mushy_layer_depth</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mushy layer depth</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>height_array</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Vertical grid points.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="mush3p.output.NonDimensionalResults.name">name</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the simulation</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="mush3p.output.NonDimensionalResults.params">params</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="mush3p.params.NonDimensionalParams" href="#mush3p.params.NonDimensionalParams">NonDimensionalParams</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Non-dimensional parameters</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="mush3p.output.NonDimensionalResults.temperature_array">temperature_array</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Temperature profile</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="mush3p.output.NonDimensionalResults.temperature_derivative_array">temperature_derivative_array</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Temperature derivative profile</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="mush3p.output.NonDimensionalResults.concentration_array">concentration_array</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Concentration profile</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="mush3p.output.NonDimensionalResults.hydrostatic_pressure_array">hydrostatic_pressure_array</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hydrostatic pressure profile</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="mush3p.output.NonDimensionalResults.frozen_gas_fraction">frozen_gas_fraction</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Frozen gas fraction</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="mush3p.output.NonDimensionalResults.mushy_layer_depth">mushy_layer_depth</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mushy layer depth</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="mush3p.output.NonDimensionalResults.height_array">height_array</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Vertical grid points</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="mush3p.output.NonDimensionalResults.solid_salinity_array">solid_salinity_array</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Solid salinity profile</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="mush3p.output.NonDimensionalResults.liquid_salinity_array">liquid_salinity_array</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Liquid salinity profile</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="mush3p.output.NonDimensionalResults.solid_fraction_array">solid_fraction_array</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Solid fraction profile</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="mush3p.output.NonDimensionalResults.liquid_fraction_array">liquid_fraction_array</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Liquid fraction profile</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="mush3p.output.NonDimensionalResults.gas_fraction_array">gas_fraction_array</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Gas fraction profile</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="mush3p.output.NonDimensionalResults.gas_density_array">gas_density_array</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Gas density profile</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="mush3p.output.NonDimensionalResults.liquid_darcy_velocity_array">liquid_darcy_velocity_array</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Liquid Darcy velocity profile</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="mush3p.output.NonDimensionalResults.gas_darcy_velocity_array">gas_darcy_velocity_array</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Gas Darcy velocity profile</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>mush3p/output.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">NonDimensionalResults</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class to store non-dimensional solution profiles and provide methods to linearly</span>
<span class="sd">    interpolate them with depth.</span>

<span class="sd">    The class also provides a save method to serialize the non-dimensional parameters</span>
<span class="sd">    and solution arrays to a JSON file, and a load method to deserialize them back into</span>
<span class="sd">    a NonDimensionalResults object.</span>

<span class="sd">    The class calcualtes all mushy layer arrays using the model specified in the</span>
<span class="sd">    non-dimensional parameters.</span>

<span class="sd">    Args:</span>
<span class="sd">        non_dimensional_parameters (NonDimensionalParams): Non-dimensional parameters</span>
<span class="sd">        temperature_array (np.ndarray): Temperature profile</span>
<span class="sd">        temperature_derivative_array (np.ndarray): Temperature derivative profile</span>
<span class="sd">        concentration_array (np.ndarray): Concentration profile</span>
<span class="sd">        hydrostatic_pressure_array (np.ndarray): Hydrostatic pressure profile</span>
<span class="sd">        frozen_gas_fraction (float): Frozen gas fraction</span>
<span class="sd">        mushy_layer_depth (float): Mushy layer depth</span>
<span class="sd">        height_array (np.ndarray): Vertical grid points.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        name (str): Name of the simulation</span>
<span class="sd">        params (NonDimensionalParams): Non-dimensional parameters</span>
<span class="sd">        temperature_array (np.ndarray): Temperature profile</span>
<span class="sd">        temperature_derivative_array (np.ndarray): Temperature derivative profile</span>
<span class="sd">        concentration_array (np.ndarray): Concentration profile</span>
<span class="sd">        hydrostatic_pressure_array (np.ndarray): Hydrostatic pressure profile</span>
<span class="sd">        frozen_gas_fraction (float): Frozen gas fraction</span>
<span class="sd">        mushy_layer_depth (float): Mushy layer depth</span>
<span class="sd">        height_array (np.ndarray): Vertical grid points</span>
<span class="sd">        solid_salinity_array (np.ndarray): Solid salinity profile</span>
<span class="sd">        liquid_salinity_array (np.ndarray): Liquid salinity profile</span>
<span class="sd">        solid_fraction_array (np.ndarray): Solid fraction profile</span>
<span class="sd">        liquid_fraction_array (np.ndarray): Liquid fraction profile</span>
<span class="sd">        gas_fraction_array (np.ndarray): Gas fraction profile</span>
<span class="sd">        gas_density_array (np.ndarray): Gas density profile</span>
<span class="sd">        liquid_darcy_velocity_array (np.ndarray): Liquid Darcy velocity profile</span>
<span class="sd">        gas_darcy_velocity_array (np.ndarray): Gas Darcy velocity profile</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">non_dimensional_parameters</span><span class="p">,</span>
        <span class="n">temperature_array</span><span class="p">,</span>
        <span class="n">temperature_derivative_array</span><span class="p">,</span>
        <span class="n">concentration_array</span><span class="p">,</span>
        <span class="n">hydrostatic_pressure_array</span><span class="p">,</span>
        <span class="n">frozen_gas_fraction</span><span class="p">,</span>
        <span class="n">mushy_layer_depth</span><span class="p">,</span>
        <span class="n">height_array</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">non_dimensional_parameters</span><span class="o">.</span><span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">non_dimensional_parameters</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">temperature_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temperature_array</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temperature_derivative_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temperature_derivative_array</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">concentration_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">concentration_array</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hydrostatic_pressure_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">hydrostatic_pressure_array</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frozen_gas_fraction</span> <span class="o">=</span> <span class="n">frozen_gas_fraction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mushy_layer_depth</span> <span class="o">=</span> <span class="n">mushy_layer_depth</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">height_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">height_array</span><span class="p">)</span>

        <span class="c1"># Calculate all mushy layer arrays</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">model_choice</span> <span class="o">==</span> <span class="s2">&quot;instant&quot;</span><span class="p">:</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">MODEL_OPTIONS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">model_choice</span><span class="p">](</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">height_array</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">temperature_array</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">temperature_derivative_array</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">hydrostatic_pressure_array</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">frozen_gas_fraction</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mushy_layer_depth</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">MODEL_OPTIONS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">model_choice</span><span class="p">](</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">height_array</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">temperature_array</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">temperature_derivative_array</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">concentration_array</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">hydrostatic_pressure_array</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">frozen_gas_fraction</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mushy_layer_depth</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">solid_salinity_array</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">solid_salinity</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">liquid_salinity_array</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">liquid_salinity</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">solid_fraction_array</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">solid_fraction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">liquid_fraction_array</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">liquid_fraction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gas_fraction_array</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">gas_fraction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gas_density_array</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">gas_density</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">liquid_darcy_velocity_array</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">liquid_darcy_velocity</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gas_darcy_velocity_array</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">gas_darcy_velocity</span>

    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;non_dimensional_parameters&quot;</span><span class="p">:</span> <span class="n">asdict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">),</span>
            <span class="s2">&quot;temperature_array&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature_array</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="s2">&quot;temperature_derivative_array&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature_derivative_array</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="s2">&quot;concentration_array&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">concentration_array</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="s2">&quot;hydrostatic_pressure_array&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">hydrostatic_pressure_array</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="s2">&quot;frozen_gas_fraction&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">frozen_gas_fraction</span><span class="p">,</span>
            <span class="s2">&quot;mushy_layer_depth&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">mushy_layer_depth</span><span class="p">,</span>
            <span class="s2">&quot;height_array&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">height_array</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
        <span class="p">}</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">.json&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;non_dimensional_parameters&quot;</span><span class="p">]</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;non_dimensional_parameters&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NonDimensionalParams</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">liquid_salinity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">height</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span>
            <span class="n">height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height_array</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_salinity_array</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">height</span><span class="p">):</span>
        <span class="n">liquid_darcy_velocity_at_bottom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_darcy_velocity_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">liquid_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
        <span class="n">liquid_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">far_temperature_scaled</span> <span class="o">*</span> <span class="p">(</span>
            <span class="mi">1</span>
            <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
                <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">liquid_darcy_velocity_at_bottom</span><span class="p">)</span>
                <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mushy_layer_depth</span>
                <span class="o">*</span> <span class="p">(</span><span class="n">liquid_range</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span>
            <span class="n">height</span><span class="p">,</span>
            <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">liquid_range</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height_array</span><span class="p">)),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">liquid_values</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature_array</span><span class="p">)),</span>
            <span class="n">left</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">far_temperature_scaled</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">concentration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">height</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span>
            <span class="n">height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height_array</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">concentration_array</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">hydrostatic_pressure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">height</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span>
            <span class="n">height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height_array</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hydrostatic_pressure_array</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">solid_fraction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">height</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span>
            <span class="n">height</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">height_array</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">solid_fraction_array</span><span class="p">,</span>
            <span class="n">right</span><span class="o">=</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">frozen_gas_fraction</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">liquid_fraction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">height</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height_array</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_fraction_array</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">gas_fraction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">height</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span>
            <span class="n">height</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">height_array</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gas_fraction_array</span><span class="p">,</span>
            <span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">right</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">frozen_gas_fraction</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">liquid_darcy_velocity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">height</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span>
            <span class="n">height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height_array</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_darcy_velocity_array</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">gas_darcy_velocity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">height</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span>
            <span class="n">height</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">height_array</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gas_darcy_velocity_array</span><span class="p">,</span>
            <span class="n">left</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
            <span class="n">right</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">gas_density</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">height</span><span class="p">):</span>
        <span class="n">gas_density_filtered</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gas_fraction_array</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_density_array</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height_array</span><span class="p">,</span> <span class="n">gas_density_filtered</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="mush3p.params" class="doc doc-heading">
            <code>params</code>


</h2>

    <div class="doc doc-contents ">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="mush3p.params.NonDimensionalParams" class="doc doc-heading">
            <code>NonDimensionalParams</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>Non-dimensional parameters for the three phase mushy layer system.</p>
<p>Note: these can be initialised directly or by using the non_dimensionalise method of PhysicalParams.</p>
<p>This class also provides save and load methods to serialize and deserialize to JSON.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the simulation</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model_choice</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Choice of model to use, either "full", "incompressible", "reduced" or "instant"</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>concentration_ratio</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ratio of the far field salinity to the salinity difference</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stefan_number</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ratio of the latent heat to the sensible heat</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>hele_shaw_permeability_scaled</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ratio of the permeability of the Hele-Shaw cell to the reference permeability</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>far_temperature_scaled</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Non-dimensionalised far field temperature</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>damkholer_number</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ratio of the thermal time scale to the nucleation time scale</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>expansion_coefficient</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Relative volume increase on exsolving a saturation amount of dissolved gas</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stokes_rise_velocity_scaled</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ratio of the bubble Stokes' rise velocity to the reference velocity</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bubble_radius_scaled</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ratio of the bubble radius to the pore throat radius</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pore_throat_exponent</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Power law exponent for pore throat radius as a function of porosity</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>far_dissolved_concentration_scaled</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ratio of the far field dissolved gas concentration to the saturation concentration</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>mush3p/params.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">NonDimensionalParams</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Non-dimensional parameters for the three phase mushy layer system.</span>

<span class="sd">    Note: these can be initialised directly or by using the non_dimensionalise method of PhysicalParams.</span>

<span class="sd">    This class also provides save and load methods to serialize and deserialize to JSON.</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): Name of the simulation</span>
<span class="sd">        model_choice (str): Choice of model to use, either &quot;full&quot;, &quot;incompressible&quot;, &quot;reduced&quot; or &quot;instant&quot;</span>
<span class="sd">        concentration_ratio (float): Ratio of the far field salinity to the salinity difference</span>
<span class="sd">        stefan_number (float): Ratio of the latent heat to the sensible heat</span>
<span class="sd">        hele_shaw_permeability_scaled (float): Ratio of the permeability of the Hele-Shaw cell to the reference permeability</span>
<span class="sd">        far_temperature_scaled (float): Non-dimensionalised far field temperature</span>
<span class="sd">        damkholer_number (float): Ratio of the thermal time scale to the nucleation time scale</span>
<span class="sd">        expansion_coefficient (float): Relative volume increase on exsolving a saturation amount of dissolved gas</span>
<span class="sd">        stokes_rise_velocity_scaled (float): Ratio of the bubble Stokes&#39; rise velocity to the reference velocity</span>
<span class="sd">        bubble_radius_scaled (float): Ratio of the bubble radius to the pore throat radius</span>
<span class="sd">        pore_throat_exponent (float): Power law exponent for pore throat radius as a function of porosity</span>
<span class="sd">        far_dissolved_concentration_scaled (float): Ratio of the far field dissolved gas concentration to the saturation concentration</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">model_choice</span><span class="p">:</span> <span class="nb">str</span>

    <span class="c1"># mushy layer params</span>
    <span class="n">concentration_ratio</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">stefan_number</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">hele_shaw_permeability_scaled</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">far_temperature_scaled</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">solid_conductivity_ratio</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">solid_specific_heat_capacity_ratio</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">gas_specific_heat_capacity_ratio</span><span class="p">:</span> <span class="nb">float</span>

    <span class="c1"># gas params</span>
    <span class="n">damkholer_number</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">expansion_coefficient</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">stokes_rise_velocity_scaled</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">bubble_radius_scaled</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">pore_throat_exponent</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">far_dissolved_concentration_scaled</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">gas_conductivity_ratio</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">gas_density_ratio</span><span class="p">:</span> <span class="nb">float</span>

    <span class="c1"># compressible gas params</span>
    <span class="n">hydrostatic_pressure_scale</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">laplace_pressure_scale</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">kelvin_conversion_temperature</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">atmospheric_pressure_scaled</span><span class="p">:</span> <span class="nb">float</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NonDimensionalParams</span><span class="p">:</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">.json&quot;</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">asdict</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="mush3p.params.PhysicalParams" class="doc doc-heading">
            <code>PhysicalParams</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>Dimensional parameters for the three phase mushy layer system.</p>
<p>This class implements the calculation of non-dimensional parameters for the system
and provides the non_dimensionalise method to provide a NonDimensionalParams object.</p>
<p>This class also provides save and load methods to serialize and deserialize to JSON.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the simulation</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model_choice</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Choice of model to use, either "full", "incompressible", "reduced" or "instant"</p>
              </div>
            </td>
            <td>
                  <code>&#39;full&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bubble_radius</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Radius of the bubbles [m]</p>
              </div>
            </td>
            <td>
                  <code>0.001</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nucleation_time_scale</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time scale for bubble nucleation [s]</p>
              </div>
            </td>
            <td>
                  <code>1000</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>far_salinity</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Salinity of the far field [g/kg]</p>
              </div>
            </td>
            <td>
                  <code>35</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>far_temperature</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Temperature of the far field [degC]</p>
              </div>
            </td>
            <td>
                  <code>0.1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>far_dissolved_gas_concentration</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dissolved gas concentration in the far field [kg/kg]</p>
              </div>
            </td>
            <td>
                  <code>3.71e-05</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>reference_velocity</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pulling speed [m/s], the default value is 1 micron/s</p>
              </div>
            </td>
            <td>
                  <code>1e-06</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>liquid_density</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Density of the liquid [kg/m3]</p>
              </div>
            </td>
            <td>
                  <code>1028</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>gravitational_acceleration</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Acceleration due to gravity [m/s2]</p>
              </div>
            </td>
            <td>
                  <code>9.81</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>liquid_dynamic_viscosity</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dynamic viscosity of the liquid [kg/m s],
the default value gives the same kinematic viscosity used in Moreau et al 2014.</p>
              </div>
            </td>
            <td>
                  <code>0.00278</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>surface_tension</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Surface tension of the liquid [N/m]</p>
              </div>
            </td>
            <td>
                  <code>0.077</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>liquidus_slope</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Slope of the liquidus curve [deg C / g/kg]</p>
              </div>
            </td>
            <td>
                  <code>0.07</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>eutectic_temperature</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Eutectic temperature [deg C]</p>
              </div>
            </td>
            <td>
                  <code>-21.2</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>latent_heat</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Latent heat of fusion [J/kg]</p>
              </div>
            </td>
            <td>
                  <code>333000.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>liquid_specific_heat_capacity</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specific heat capacity of the liquid [J/kg degC]</p>
              </div>
            </td>
            <td>
                  <code>4209</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>solid_specific_heat_capacity</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specific heat capacity of the solid [J/kg degC]</p>
              </div>
            </td>
            <td>
                  <code>2108</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>gas_specific_heat_capacity</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specific heat capacity of the gas [J/kg degC]</p>
              </div>
            </td>
            <td>
                  <code>1004</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>liquid_thermal_conductivity</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Thermal conductivity of the liquid [W/m degC]</p>
              </div>
            </td>
            <td>
                  <code>0.523</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>solid_thermal_conductivity</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Thermal conductivity of the solid [W/m degC]</p>
              </div>
            </td>
            <td>
                  <code>2.22</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>gas_thermal_conductivity</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Thermal conductivity of the gas [W/m degC]</p>
              </div>
            </td>
            <td>
                  <code>0.02</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>hele_shaw_gap_width</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Width of the Hele-Shaw cell [m], the default value
is the same value used in the experiments of Peppin et al 2007</p>
              </div>
            </td>
            <td>
                  <code>0.005</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>reference_permeability</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Reference permeability [m2], the defulat value
is the value used in Rees Jones and Worster 2014</p>
              </div>
            </td>
            <td>
                  <code>1e-08</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>reference_pore_scale</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fitted pore throat radius at zero solid fraction [m],
default value from Maus et al 2021</p>
              </div>
            </td>
            <td>
                  <code>0.000195</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pore_throat_exponent</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exponent for pore throat radius power law as a function of porosity,
default value from Maus et al 2021</p>
              </div>
            </td>
            <td>
                  <code>0.46</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>reference_saturation_concentration</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Saturation concentration for dissolved gas [kg/kg]</p>
              </div>
            </td>
            <td>
                  <code>3.71e-05</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>specific_gas_constant</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specific gas constant [J/kg degK]</p>
              </div>
            </td>
            <td>
                  <code>286</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>atmospheric_pressure</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Atmospheric pressure [Pa]</p>
              </div>
            </td>
            <td>
                  <code>101000.0</code>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>mush3p/params.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">PhysicalParams</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Dimensional parameters for the three phase mushy layer system.</span>

<span class="sd">    This class implements the calculation of non-dimensional parameters for the system</span>
<span class="sd">    and provides the non_dimensionalise method to provide a NonDimensionalParams object.</span>

<span class="sd">    This class also provides save and load methods to serialize and deserialize to JSON.</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): Name of the simulation</span>
<span class="sd">        model_choice (str): Choice of model to use, either &quot;full&quot;, &quot;incompressible&quot;, &quot;reduced&quot; or &quot;instant&quot;</span>
<span class="sd">        bubble_radius (float): Radius of the bubbles [m]</span>
<span class="sd">        nucleation_time_scale (float): Time scale for bubble nucleation [s]</span>
<span class="sd">        far_salinity (float): Salinity of the far field [g/kg]</span>
<span class="sd">        far_temperature (float): Temperature of the far field [degC]</span>
<span class="sd">        far_dissolved_gas_concentration (float): Dissolved gas concentration in the far field [kg/kg]</span>
<span class="sd">        reference_velocity (float): Pulling speed [m/s], the default value is 1 micron/s</span>
<span class="sd">        liquid_density (float): Density of the liquid [kg/m3]</span>
<span class="sd">        gravitational_acceleration (float): Acceleration due to gravity [m/s2]</span>
<span class="sd">        liquid_dynamic_viscosity (float): Dynamic viscosity of the liquid [kg/m s],</span>
<span class="sd">            the default value gives the same kinematic viscosity used in Moreau et al 2014.</span>
<span class="sd">        surface_tension (float): Surface tension of the liquid [N/m]</span>
<span class="sd">        liquidus_slope (float): Slope of the liquidus curve [deg C / g/kg]</span>
<span class="sd">        eutectic_temperature (float): Eutectic temperature [deg C]</span>
<span class="sd">        latent_heat (float): Latent heat of fusion [J/kg]</span>
<span class="sd">        liquid_specific_heat_capacity (float): Specific heat capacity of the liquid [J/kg degC]</span>
<span class="sd">        solid_specific_heat_capacity (float): Specific heat capacity of the solid [J/kg degC]</span>
<span class="sd">        gas_specific_heat_capacity (float): Specific heat capacity of the gas [J/kg degC]</span>
<span class="sd">        liquid_thermal_conductivity (float): Thermal conductivity of the liquid [W/m degC]</span>
<span class="sd">        solid_thermal_conductivity (float): Thermal conductivity of the solid [W/m degC]</span>
<span class="sd">        gas_thermal_conductivity (float): Thermal conductivity of the gas [W/m degC]</span>
<span class="sd">        hele_shaw_gap_width (float): Width of the Hele-Shaw cell [m], the default value</span>
<span class="sd">            is the same value used in the experiments of Peppin et al 2007</span>
<span class="sd">        reference_permeability (float): Reference permeability [m2], the defulat value</span>
<span class="sd">            is the value used in Rees Jones and Worster 2014</span>
<span class="sd">        reference_pore_scale (float): Fitted pore throat radius at zero solid fraction [m],</span>
<span class="sd">            default value from Maus et al 2021</span>
<span class="sd">        pore_throat_exponent (float): Exponent for pore throat radius power law as a function of porosity,</span>
<span class="sd">            default value from Maus et al 2021</span>
<span class="sd">        reference_saturation_concentration (float): Saturation concentration for dissolved gas [kg/kg]</span>
<span class="sd">        specific_gas_constant (float): Specific gas constant [J/kg degK]</span>
<span class="sd">        atmospheric_pressure (float): Atmospheric pressure [Pa]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">model_choice</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;full&quot;</span>
    <span class="n">bubble_radius</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-3</span>
    <span class="n">nucleation_time_scale</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">far_salinity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">35</span>
    <span class="n">far_temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">far_dissolved_gas_concentration</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">3.71e-5</span>
    <span class="n">reference_velocity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-6</span>
    <span class="n">liquid_density</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1028</span>
    <span class="n">gravitational_acceleration</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">9.81</span>
    <span class="n">liquid_dynamic_viscosity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.78e-3</span>
    <span class="n">surface_tension</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">77e-3</span>
    <span class="n">liquidus_slope</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.07</span>
    <span class="n">eutectic_temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">21.2</span>
    <span class="n">latent_heat</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">333e3</span>
    <span class="n">liquid_specific_heat_capacity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">4209</span>
    <span class="n">solid_specific_heat_capacity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">2108</span>
    <span class="n">gas_specific_heat_capacity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1004</span>
    <span class="n">liquid_thermal_conductivity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.523</span>
    <span class="n">solid_thermal_conductivity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.22</span>
    <span class="n">gas_thermal_conductivity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2e-2</span>
    <span class="n">hele_shaw_gap_width</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5e-3</span>
    <span class="n">reference_permeability</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-8</span>
    <span class="n">reference_pore_scale</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.95e-4</span>
    <span class="n">pore_throat_exponent</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.46</span>
    <span class="n">reference_saturation_concentration</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">3.71e-5</span>
    <span class="n">specific_gas_constant</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">286</span>
    <span class="n">atmospheric_pressure</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.01e5</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">initial_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Liquidus freezing temperature of the liquid at salinty far_salinity&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">liquidus_slope</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">far_salinity</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">eutectic_salinity</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculated eutectic salinity from linear liquidus relation&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">eutectic_temperature</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquidus_slope</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">liquid_thermal_diffusivity</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_thermal_conductivity</span> <span class="o">/</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">liquid_density</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_specific_heat_capacity</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">length_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_thermal_diffusivity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_velocity</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">time_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_thermal_diffusivity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_velocity</span><span class="o">**</span><span class="mi">2</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">reference_gas_density</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">atmospheric_pressure</span> <span class="o">/</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">specific_gas_constant</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_temperature</span> <span class="o">+</span> <span class="n">CELSIUS_TO_KELVIN</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">gas_density_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_gas_density</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_density</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">pressure_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">liquid_thermal_diffusivity</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_dynamic_viscosity</span>
            <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_permeability</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">concentration_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">salinity_diff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eutectic_salinity</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">far_salinity</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">far_salinity</span> <span class="o">/</span> <span class="n">salinity_diff</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">stefan_number</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">temperature_diff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_temperature</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">eutectic_temperature</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">latent_heat</span> <span class="o">/</span> <span class="p">(</span>
            <span class="n">temperature_diff</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_specific_heat_capacity</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">hele_shaw_permeability_scaled</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">hele_shaw_gap_width</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">12</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_permeability</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">far_temperature_scaled</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">far_temperature</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_temperature</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initial_temperature</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">eutectic_temperature</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">damkholer_number</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_scale</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">nucleation_time_scale</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">expansion_coefficient</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">liquid_density</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_saturation_concentration</span>
        <span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_gas_density</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">stokes_rise_velocity_scaled</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">liquid_density</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gravitational_acceleration</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_pore_scale</span><span class="o">**</span><span class="mi">2</span>
        <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_dynamic_viscosity</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_velocity</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">bubble_radius_scaled</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bubble_radius</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_pore_scale</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">far_dissolved_concentration_scaled</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">far_dissolved_gas_concentration</span>
            <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_saturation_concentration</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">gas_conductivity_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_thermal_conductivity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_thermal_conductivity</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">solid_conductivity_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">solid_thermal_conductivity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_thermal_conductivity</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">solid_specific_heat_capacity_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">solid_specific_heat_capacity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_specific_heat_capacity</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">gas_specific_heat_capacity_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_specific_heat_capacity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_specific_heat_capacity</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">hydrostatic_pressure_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">liquid_density</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gravitational_acceleration</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_thermal_diffusivity</span>
        <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atmospheric_pressure</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_velocity</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">laplace_pressure_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">surface_tension</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bubble_radius</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">atmospheric_pressure</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">kelvin_conversion_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_temperature</span> <span class="o">+</span> <span class="n">CELSIUS_TO_KELVIN</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initial_temperature</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">eutectic_temperature</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">atmospheric_pressure_scaled</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">atmospheric_pressure</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">pressure_scale</span>

    <span class="k">def</span> <span class="nf">non_dimensionalise</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NonDimensionalParams</span><span class="p">:</span>
        <span class="n">non_dimensional_params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;model_choice&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_choice</span><span class="p">,</span>
            <span class="s2">&quot;concentration_ratio&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">concentration_ratio</span><span class="p">,</span>
            <span class="s2">&quot;stefan_number&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">stefan_number</span><span class="p">,</span>
            <span class="s2">&quot;hele_shaw_permeability_scaled&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">hele_shaw_permeability_scaled</span><span class="p">,</span>
            <span class="s2">&quot;far_temperature_scaled&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">far_temperature_scaled</span><span class="p">,</span>
            <span class="s2">&quot;damkholer_number&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">damkholer_number</span><span class="p">,</span>
            <span class="s2">&quot;expansion_coefficient&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">expansion_coefficient</span><span class="p">,</span>
            <span class="s2">&quot;stokes_rise_velocity_scaled&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">stokes_rise_velocity_scaled</span><span class="p">,</span>
            <span class="s2">&quot;bubble_radius_scaled&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">bubble_radius_scaled</span><span class="p">,</span>
            <span class="s2">&quot;pore_throat_exponent&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pore_throat_exponent</span><span class="p">,</span>
            <span class="s2">&quot;far_dissolved_concentration_scaled&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">far_dissolved_concentration_scaled</span><span class="p">,</span>
            <span class="s2">&quot;gas_conductivity_ratio&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_conductivity_ratio</span><span class="p">,</span>
            <span class="s2">&quot;solid_conductivity_ratio&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">solid_conductivity_ratio</span><span class="p">,</span>
            <span class="s2">&quot;solid_specific_heat_capacity_ratio&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">solid_specific_heat_capacity_ratio</span><span class="p">,</span>
            <span class="s2">&quot;gas_specific_heat_capacity_ratio&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_specific_heat_capacity_ratio</span><span class="p">,</span>
            <span class="s2">&quot;hydrostatic_pressure_scale&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">hydrostatic_pressure_scale</span><span class="p">,</span>
            <span class="s2">&quot;laplace_pressure_scale&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">laplace_pressure_scale</span><span class="p">,</span>
            <span class="s2">&quot;kelvin_conversion_temperature&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kelvin_conversion_temperature</span><span class="p">,</span>
            <span class="s2">&quot;atmospheric_pressure_scaled&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">atmospheric_pressure_scaled</span><span class="p">,</span>
            <span class="s2">&quot;gas_density_ratio&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_density_ratio</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">NonDimensionalParams</span><span class="p">(</span><span class="o">**</span><span class="n">non_dimensional_params</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PhysicalParams</span><span class="p">:</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">.json&quot;</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">asdict</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="mush3p.params.PhysicalParams.eutectic_salinity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">eutectic_salinity</span><span class="p">:</span> <span class="nb">float</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Calculated eutectic salinity from linear liquidus relation</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="mush3p.params.PhysicalParams.initial_temperature" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">initial_temperature</span><span class="p">:</span> <span class="nb">float</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Liquidus freezing temperature of the liquid at salinty far_salinity</p>
    </div>

</div>





  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="mush3p.static_settings" class="doc doc-heading">
            <code>static_settings</code>


</h2>

    <div class="doc doc-contents ">








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="mush3p.static_settings.get_initial_solution" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_initial_solution</span><span class="p">(</span><span class="n">model_choice</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get intial solution for scipy solve_BVP which satisfies the boundary conditions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model_choice</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>one of "full", "incompressible" "reduced" or "instant"</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Returns:
    NDArray: initial solution for scipy solve_BVP</p>

            <details class="quote">
              <summary>Source code in <code>mush3p/static_settings.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_initial_solution</span><span class="p">(</span><span class="n">model_choice</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get intial solution for scipy solve_BVP which satisfies the boundary conditions.</span>

<span class="sd">    Args:</span>
<span class="sd">        model_choice (str): one of &quot;full&quot;, &quot;incompressible&quot; &quot;reduced&quot; or &quot;instant&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">        NDArray: initial solution for scipy solve_BVP</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">model_choice</span> <span class="o">==</span> <span class="s2">&quot;instant&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="n">INITIAL_TEMPERATURE</span><span class="p">,</span>
                <span class="n">INITIAL_TEMPERATURE_DERIVATIVE</span><span class="p">,</span>
                <span class="n">INITIAL_HYDROSTATIC_PRESSURE</span><span class="p">,</span>
                <span class="n">INITIAL_FROZEN_GAS_FRACTION</span><span class="p">,</span>
                <span class="n">INITIAL_MUSHY_LAYER_DEPTH</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span>
        <span class="p">(</span>
            <span class="n">INITIAL_TEMPERATURE</span><span class="p">,</span>
            <span class="n">INITIAL_TEMPERATURE_DERIVATIVE</span><span class="p">,</span>
            <span class="n">INITIAL_DISSOLVED_GAS_CONCENTRATION</span><span class="p">,</span>
            <span class="n">INITIAL_HYDROSTATIC_PRESSURE</span><span class="p">,</span>
            <span class="n">INITIAL_FROZEN_GAS_FRACTION</span><span class="p">,</span>
            <span class="n">INITIAL_MUSHY_LAYER_DEPTH</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": [], "search": "assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>